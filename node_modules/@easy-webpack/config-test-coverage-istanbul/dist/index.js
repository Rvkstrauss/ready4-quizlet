"use strict";
var core_1 = require('@easy-webpack/core');
var path = require('path');
module.exports = function istanbul(_a) {
    var _b = _a === void 0 ? {} : _a, _c = _b.include, include = _c === void 0 ? undefined : _c, _d = _b.exclude, exclude = _d === void 0 ? undefined : _d, _e = _b.options, options = _e === void 0 ? { 'force-sourcemap': true } : _e;
    return function istanbul() {
        return {
            module: {
                rules: core_1.get(this, 'module.rules', []).concat([{
                        test: /\.(js|ts)$/,
                        loader: 'sourcemap-istanbul-instrumenter-loader',
                        query: options,
                        enforce: 'post',
                        include: include || this.metadata.src,
                        exclude: exclude || (this.metadata.root ? [path.join(this.metadata.root, 'node_modules')] : []),
                    }])
            }
        };
    };
};
//# sourceMappingURL=index.js.map